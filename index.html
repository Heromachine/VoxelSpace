<!--
    VoxelSpace FPS Game

    Based on VoxelSpace by Sebastian Macke (s-macke)
    Original repository: https://github.com/s-macke/VoxelSpace

    The Voxel Space rendering engine and terrain maps are derived from
    the original project, which reverse-engineered the technique from
    NovaLogic's Comanche (1992).

    Original code licensed under MIT License.
    Terrain maps are reverse-engineered from Comanche and excluded from license.

    Modifications and game features by Heromachine
-->
<!DOCTYPE html>
<html>
<head>
    <title>Voxel Space Game</title>
    <meta charset="UTF-8">
    <style>
        html, body {margin: 0; height: 100%; overflow: hidden; background: #000;}

        /* ── Multiplayer overlay base ── */
        .mp-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: #080f16;
            color: #8ab0c8;
            font-family: 'Segoe UI', system-ui, sans-serif;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 32px;
            z-index: 1000;
            padding: 40px 20px;
        }
        .mp-overlay header { text-align: center; }
        .mp-overlay h1 { font-size: 1.1rem; letter-spacing: 5px; text-transform: uppercase; color: #5a90b0; font-weight: 400; }
        .mp-overlay .tagline { font-size: 0.72rem; opacity: 0.35; letter-spacing: 2px; margin-top: 6px; }

        /* ── Login screen ── */
        #login-screen .login-box {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(80,160,220,0.12);
            border-radius: 4px;
            padding: 28px 32px;
            width: 100%;
            max-width: 360px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        #login-screen input {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(80,160,220,0.15);
            border-radius: 3px;
            color: #c0d8e8;
            padding: 9px 12px;
            font-size: 0.85rem;
            outline: none;
            width: 100%;
            box-sizing: border-box;
        }
        #login-screen input:focus { border-color: rgba(80,160,220,0.4); }
        .mp-btn {
            padding: 10px 16px;
            border: 1px solid rgba(80,160,220,0.2);
            border-radius: 3px;
            background: rgba(80,140,200,0.1);
            color: #8ab0c8;
            cursor: pointer;
            font-size: 0.8rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            transition: background 0.15s, border-color 0.15s;
        }
        .mp-btn:hover { background: rgba(80,140,200,0.2); border-color: rgba(80,160,220,0.4); }
        .mp-btn.anon  { background: rgba(60,60,60,0.3); border-color: rgba(120,120,120,0.2); color: #607080; }
        .mp-btn.steam { background: rgba(30,60,100,0.3); border-color: rgba(60,120,180,0.25); }
        .mp-divider   { border: none; border-top: 1px solid rgba(80,160,220,0.08); margin: 4px 0; }
        #login-status { font-size: 0.72rem; min-height: 16px; text-align: center; }

        /* ── Clan selection ── */
        #clan-screen .cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; width: 100%; max-width: 700px; }
        .clan-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(80,160,220,0.08);
            border-radius: 4px;
            padding: 22px 20px 18px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            cursor: pointer;
            transition: background 0.15s, border-color 0.15s;
        }
        .clan-num  { font-size: 1.8rem; font-weight: 700; line-height: 1; }
        .clan-name { font-size: 0.9rem; letter-spacing: 1px; font-weight: 400; }
        .clan-desc { font-size: 0.7rem; line-height: 1.6; opacity: 0.45; }
        .clan-badge { display: inline-block; font-size: 0.6rem; letter-spacing: 1.5px; text-transform: uppercase; padding: 2px 7px; border-radius: 2px; margin-top: 4px; align-self: flex-start; background: rgba(80,120,160,0.1); color: rgba(120,160,190,0.7); border: 1px solid rgba(80,120,160,0.2); }
        #clan-note { font-size: 0.68rem; opacity: 0.3; letter-spacing: 1px; text-align: center; }

        /* ── Kick screen ── */
        #kick-screen .kick-box { text-align: center; display: flex; flex-direction: column; gap: 16px; }
        .kick-icon   { font-size: 3rem; }
        .kick-title  { font-size: 1rem; letter-spacing: 4px; text-transform: uppercase; color: #e05050; }
        .kick-reason { font-size: 0.8rem; opacity: 0.5; letter-spacing: 1px; }
        .kick-sub    { font-size: 0.7rem; opacity: 0.3; }

        /* ── In-game notifications ── */
        #mp-notification {
            position: fixed;
            top: 16px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.7);
            color: #8ab0c8;
            font-family: 'Segoe UI', system-ui, sans-serif;
            font-size: 0.75rem;
            letter-spacing: 1px;
            padding: 6px 16px;
            border-radius: 3px;
            border: 1px solid rgba(80,160,220,0.15);
            z-index: 500;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.4s;
        }

        /* Game container - holds canvas and HUD, gets centered */
        #game-container {
            position: absolute;
            overflow: hidden;
        }

        #game-container canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: block;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }

        #crosshair {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 10px;
            height: 10px;
            margin: -5px 0 0 -5px;
            z-index: 10;
            border: 2px solid white;
            border-radius: 50%;
            pointer-events: none;
            z-index: 100;
        }

        #healthbar {
            position: absolute;
            bottom: 18px;
            left: 10px;
            width: 180px;
            height: 8px;
            background: rgba(8,15,22,0.82);
            border: 1px solid rgba(80,160,220,0.3);
            border-radius: 4px;
            overflow: hidden;
            z-index: 10;
        }

        #jumpbar {
            position: absolute;
            bottom: 10px;
            left: 10px;
            width: 180px;
            height: 3px;
            background: rgba(255,255,255,0.07);
            border-radius: 2px;
            display: none;
            z-index: 10;
        }

        #jumpcharge {
            width: 0%;
            height: 100%;
            background: rgba(80,160,220,0.85);
            border-radius: inherit;
            transition: width 0.05s;
        }

        #health {
            width: 100%;
            height: 100%;
            background: rgba(175,50,60,0.9);
            border-radius: inherit;
            transition: width 0.1s;
        }
        /* Debug info and controls hidden - moved to Debug tab */
        #info, #fps, #bulletcount, #lastbulletpos, #lastbulletscreen, #playerrotation,
        #playerposition, #lastbulletdestroyedpos, #lastbulletdestroyedreason {
            display: none;
        }

        /* ── HUD elements ── */
        #jumpbar {
            border: none !important;
        }
        #crosshair {
            border-color: rgba(138,176,200,0.75) !important;
        }

        /* ── Settings panel ── */
        #controls {
            font-family: 'Segoe UI', system-ui, sans-serif !important;
            color: #8ab0c8 !important;
        }
        #controls label {
            color: #8ab0c8;
            font-size: 11px;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        #controls b { color: #5a90b0; }
        #controls hr { border: none !important; border-top: 1px solid rgba(80,160,220,0.12) !important; margin: 8px 0; }
        #controls input[type=range]     { accent-color: rgba(80,160,220,0.8); width: 100%; }
        #controls input[type=checkbox]  { accent-color: rgba(80,160,220,0.8); }
        #controls select { background: rgba(8,15,22,0.9); color: #8ab0c8; border: 1px solid rgba(80,160,220,0.2); border-radius: 3px; }
        #controls span   { color: #8ab0c8; }
    </style>
</head>
<body>

    <!-- ── In-game notification toast ── -->
<div id="mp-notification"></div>

<!-- ══════════════════════════════════════ -->
<!-- LOGIN SCREEN                          -->
<!-- ══════════════════════════════════════ -->
<div id="login-screen" class="mp-overlay" style="display:flex;">
  <header>
    <h1>VoxelSpace</h1>
    <p class="tagline">Open World Survival — Player vs Player</p>
  </header>

  <div class="login-box">
    <!-- Username / Password -->
    <input id="login-username" type="text"     placeholder="Username" autocomplete="username">
    <input id="login-password" type="password" placeholder="Password (min 8 chars)" autocomplete="current-password">
    <button id="login-pw-btn" class="mp-btn">Sign In / Register</button>

    <hr class="mp-divider">

    <button id="login-steam-btn" class="mp-btn steam">Sign in with Steam</button>
    <button id="login-anon-btn"  class="mp-btn anon">Play as Guest (no persistence)</button>

    <div id="login-status"></div>
  </div>
</div>

<!-- ══════════════════════════════════════ -->
<!-- CLAN SELECTION SCREEN                 -->
<!-- ══════════════════════════════════════ -->
<div id="clan-screen" class="mp-overlay">
  <header>
    <h1>Choose Your Clan</h1>
    <p class="tagline">Your choice is permanent and secret. Nobody will know.</p>
  </header>

  <div id="clan-cards" class="cards"></div>

  <p id="clan-note">Friendly fire results in an immediate kick.</p>
</div>

<!-- ══════════════════════════════════════ -->
<!-- KICK SCREEN                           -->
<!-- ══════════════════════════════════════ -->
<div id="kick-screen" class="mp-overlay">
  <div class="kick-box">
    <div class="kick-icon">⚠</div>
    <div class="kick-title">Kicked</div>
    <div class="kick-reason"></div>
    <div class="kick-sub">Refresh the page to reconnect.</div>
  </div>
</div>

<div id="controls" style="display: none; position: absolute; top: 50px; left: 10px; background: rgba(8,15,22,0.95); color: #8ab0c8; padding: 0; width: 360px; border-radius: 4px; overflow: hidden; z-index: 100; border: 1px solid rgba(80,160,220,0.15); font-family: 'Segoe UI', system-ui, sans-serif;">
  <!-- Panel Title -->
  <div style="background: rgba(80,160,220,0.06); padding: 8px 12px; font-size: 11px; letter-spacing: 2px; text-transform: uppercase; color: #5a90b0; border-bottom: 1px solid rgba(80,160,220,0.12);">Settings <span style="float:right; font-size:10px; color: rgba(138,176,200,0.35); letter-spacing:1px;">[ESC] toggle</span></div>
  <!-- Tab buttons -->
  <div style="display: flex; background: rgba(80,160,220,0.03); border-bottom: 1px solid rgba(80,160,220,0.1);">
    <button class="tab-btn active" data-tab="camera" style="flex:1;padding:7px 2px;border:none;background:rgba(80,160,220,0.15);color:#8ab0c8;cursor:pointer;font-size:10px;font-family:inherit;letter-spacing:0.5px;">Camera</button>
    <button class="tab-btn" data-tab="player" style="flex:1;padding:7px 2px;border:none;background:transparent;color:rgba(138,176,200,0.45);cursor:pointer;font-size:10px;font-family:inherit;letter-spacing:0.5px;">Player</button>
    <button class="tab-btn" data-tab="bullet" style="flex:1;padding:7px 2px;border:none;background:transparent;color:rgba(138,176,200,0.45);cursor:pointer;font-size:10px;font-family:inherit;letter-spacing:0.5px;">Bullet</button>
    <button class="tab-btn" data-tab="hit" style="flex:1;padding:7px 2px;border:none;background:transparent;color:rgba(138,176,200,0.45);cursor:pointer;font-size:10px;font-family:inherit;letter-spacing:0.5px;">Hit</button>
    <button class="tab-btn" data-tab="gun" style="flex:1;padding:7px 2px;border:none;background:transparent;color:rgba(138,176,200,0.45);cursor:pointer;font-size:10px;font-family:inherit;letter-spacing:0.5px;">Gun</button>
    <button class="tab-btn" data-tab="barrel" style="flex:1;padding:7px 2px;border:none;background:transparent;color:rgba(138,176,200,0.45);cursor:pointer;font-size:10px;font-family:inherit;letter-spacing:0.5px;">Barrel</button>
    <button class="tab-btn" data-tab="ui" style="flex:1;padding:7px 2px;border:none;background:transparent;color:rgba(138,176,200,0.45);cursor:pointer;font-size:10px;font-family:inherit;letter-spacing:0.5px;">UI</button>
    <button class="tab-btn" data-tab="gmd" style="flex:1;padding:7px 2px;border:none;background:transparent;color:rgba(138,176,200,0.45);cursor:pointer;font-size:10px;font-family:inherit;letter-spacing:0.5px;">GMD</button>
    <button class="tab-btn" data-tab="debug" style="flex:1;padding:7px 2px;border:none;background:transparent;color:rgba(138,176,200,0.45);cursor:pointer;font-size:10px;font-family:inherit;letter-spacing:0.5px;">Debug</button>
  </div>

  <!-- Camera Tab -->
  <div class="tab-content" id="tab-camera" style="padding: 10px;">
    <label for="fov">Focal Length: <span id="fov-value">300</span></label><br>
    <input type="range" id="fov" min="100" max="800" value="300" style="width:100%;"><br>

    <label for="pitchOffset">Pitch Offset: <span id="pitchOffset-value">250</span></label><br>
    <input type="range" id="pitchOffset" min="0" max="500" value="250" style="width:100%;"><br>

    <label for="targetFPS">Target FPS: <span id="targetFPS-value">60</span></label><br>
    <input type="range" id="targetFPS" min="30" max="120" value="60" style="width:100%;"><br>

    <label for="drawDistance">Draw Distance: <span id="drawDistance-value">2000</span></label><br>
    <input type="range" id="drawDistance" min="500" max="5000" value="2000" style="width:100%;"><br>

    <label for="frames">Frames: <span id="frames-value">0</span></label><br>
    <input type="range" id="frames" min="0" max="1000" value="0" style="width:100%;">
  </div>

  <!-- Player Tab -->
  <div class="tab-content" id="tab-player" style="padding: 10px; display: none;">
    <label for="playerHeight">Eye Height: <span id="playerHeight-value">30</span></label><br>
    <input type="range" id="playerHeight" min="5" max="150" value="30" style="width:100%;"><br>

    <label for="normalHeight">Standing: <span id="normalHeight-value">78</span></label><br>
    <input type="range" id="normalHeight" min="40" max="150" value="78" style="width:100%;"><br>

    <label for="crouchHeight">Crouch: <span id="crouchHeight-value">40</span></label><br>
    <input type="range" id="crouchHeight" min="20" max="100" value="40" style="width:100%;"><br>

    <label for="jumpMin">Jump Min: <span id="jumpMin-value">3</span></label><br>
    <input type="range" id="jumpMin" min="1" max="10" value="3" style="width:100%;"><br>

    <label for="jumpMax">Jump Max: <span id="jumpMax-value">12</span></label><br>
    <input type="range" id="jumpMax" min="5" max="30" value="12" style="width:100%;"><br>

    <hr style="border-color:#555;margin:8px 0;">
    <label for="walkSpeed">Walk Speed: <span id="walkSpeed-value">1.5</span></label><br>
    <input type="range" id="walkSpeed" min="0.5" max="5" step="0.1" value="1.5" style="width:100%;"><br>

    <label for="sprintMultiplier">Sprint Multiplier: <span id="sprintMultiplier-value">2.0</span>x</label><br>
    <input type="range" id="sprintMultiplier" min="1" max="5" step="0.1" value="2" style="width:100%;">
  </div>

  <!-- Bullet Tab -->
  <div class="tab-content" id="tab-bullet" style="padding: 10px; display: none;">
    <label for="bulletSize">Size: <span id="bulletSize-value">0.75</span></label><br>
    <input type="range" id="bulletSize" min="0.1" max="3" step="0.1" value="0.75" style="width:100%;"><br>

    <label for="barrelDistance">Barrel Dist: <span id="barrelDistance-value">5</span></label><br>
    <input type="range" id="barrelDistance" min="1" max="50" value="5" style="width:100%;">
  </div>

  <!-- Hit Detection Tab -->
  <div class="tab-content" id="tab-hit" style="padding: 10px; display: none;">
    <b style="font-size:10px; color:rgba(200,100,100,0.8);">Hitscan (Instant)</b><br>
    <label for="hitscanDist">Distance: <span id="hitscanDist-value">50</span></label><br>
    <input type="range" id="hitscanDist" min="0" max="200" value="50" style="width:100%;"><br>

    <b style="font-size:10px; color:rgba(80,160,220,0.8);">CCD (Projectile)</b><br>
    <label for="ccdMaxDist">Max Distance: <span id="ccdMaxDist-value">500</span></label><br>
    <input type="range" id="ccdMaxDist" min="100" max="1000" step="50" value="500" style="width:100%;"><br>

    <label style="font-size:11px;"><input type="checkbox" id="showHitRanges" checked> Show range circles on minimap</label>
  </div>

  <!-- Gun Tab -->
  <div class="tab-content" id="tab-gun" style="padding: 10px; display: none;">
    <div style="margin-bottom:8px;">
      <b style="font-size:10px;">Edit Position:</b>
      <button id="editADS" style="padding:2px 8px;margin-left:5px;background:rgba(80,160,220,0.2);color:#8ab0c8;border:1px solid rgba(80,160,220,0.3);border-radius:3px;cursor:pointer;font-family:inherit;">ADS</button>
      <button id="editHip" style="padding:2px 8px;margin-left:5px;background:rgba(80,140,200,0.08);color:rgba(138,176,200,0.5);border:1px solid rgba(80,160,220,0.15);border-radius:3px;cursor:pointer;font-family:inherit;">Hip</button>
      <span id="editModeLabel" style="margin-left:10px;font-size:10px;color:#5a90b0;">[Editing ADS]</span>
    </div>

    <label for="gunX">X Offset: <span id="gunX-value">0</span></label><br>
    <input type="range" id="gunX" min="-200" max="400" value="0" style="width:100%;"><br>

    <label for="gunY">Y Offset: <span id="gunY-value">100</span></label><br>
    <input type="range" id="gunY" min="-200" max="400" value="100" style="width:100%;"><br>

    <label for="gunZ">Z Depth: <span id="gunZ-value">0</span></label><br>
    <input type="range" id="gunZ" min="-100" max="100" value="0" style="width:100%;"><br>

    <label for="gunScale">Scale: <span id="gunScale-value">350</span></label><br>
    <input type="range" id="gunScale" min="50" max="1000" value="350" style="width:100%;"><br>

    <label for="gunRotX">Rot X: <span id="gunRotX-value">0</span></label><br>
    <input type="range" id="gunRotX" min="-180" max="180" value="0" style="width:100%;"><br>

    <label for="gunRotY">Rot Y: <span id="gunRotY-value">0</span></label><br>
    <input type="range" id="gunRotY" min="-180" max="180" value="0" style="width:100%;"><br>

    <label for="gunRotZ">Rot Z: <span id="gunRotZ-value">0</span></label><br>
    <input type="range" id="gunRotZ" min="-180" max="180" value="0" style="width:100%;">
  </div>

  <!-- Barrel Tab -->
  <div class="tab-content" id="tab-barrel" style="padding: 10px; display: none;">
    <div style="margin-bottom:8px;">
      <b style="font-size:10px;">Edit Position:</b>
      <button id="barrelEditADS" style="padding:2px 8px;margin-left:5px;background:rgba(80,160,220,0.2);color:#8ab0c8;border:1px solid rgba(80,160,220,0.3);border-radius:3px;cursor:pointer;font-family:inherit;">ADS</button>
      <button id="barrelEditHip" style="padding:2px 8px;margin-left:5px;background:rgba(80,140,200,0.08);color:rgba(138,176,200,0.5);border:1px solid rgba(80,160,220,0.15);border-radius:3px;cursor:pointer;font-family:inherit;">Hip</button>
      <span id="barrelEditModeLabel" style="margin-left:10px;font-size:10px;color:#5a90b0;">[Editing ADS]</span>
    </div>

    <label for="barrelYaw">Barrel Yaw: <span id="barrelYaw-value">0</span>°</label><br>
    <input type="range" id="barrelYaw" min="-45" max="45" value="0" style="width:100%;"><br>

    <hr style="border-color:#555;margin:8px 0;">
    <b style="font-size:10px;">Barrel Tip (gun-relative):</b><br>
    <label for="barrelX">Forward: <span id="barrelX-value">0.26</span></label><br>
    <input type="range" id="barrelX" min="-0.5" max="0.5" step="0.01" value="0.26" style="width:100%;"><br>

    <label for="barrelY">Up: <span id="barrelY-value">0.08</span></label><br>
    <input type="range" id="barrelY" min="-0.3" max="0.3" step="0.01" value="0.08" style="width:100%;"><br>

    <label for="barrelZ">Right: <span id="barrelZ-value">0</span></label><br>
    <input type="range" id="barrelZ" min="-0.3" max="0.3" step="0.01" value="0" style="width:100%;"><br>

    <hr style="border-color:#555;margin:8px 0;">
    <b style="font-size:10px;">Gun World Offset:</b><br>
    <label for="gunWorldFwd">Forward: <span id="gunWorldFwd-value">10</span></label><br>
    <input type="range" id="gunWorldFwd" min="0" max="50" value="10" style="width:100%;"><br>

    <label for="gunWorldRight">Right: <span id="gunWorldRight-value">15</span></label><br>
    <input type="range" id="gunWorldRight" min="-30" max="30" value="15" style="width:100%;"><br>

    <label for="gunWorldDown">Down: <span id="gunWorldDown-value">8</span></label><br>
    <input type="range" id="gunWorldDown" min="-20" max="30" value="8" style="width:100%;">
  </div>

  <!-- UI Tab -->
  <div class="tab-content" id="tab-ui" style="padding: 10px; display: none;">
    <b style="font-size:10px;">Master Scale:</b><br>
    <label for="uiScaleAll">All UI: <span id="uiScaleAll-value">1.0</span>x</label><br>
    <input type="range" id="uiScaleAll" min="0.5" max="2.0" step="0.1" value="1.0" style="width:100%;"><br>

    <hr style="border-color:#555;margin:8px 0;">
    <b style="font-size:10px;">Individual Scales:</b><br>

    <label for="uiScaleCrosshair">Crosshair: <span id="uiScaleCrosshair-value">1.0</span>x</label><br>
    <input type="range" id="uiScaleCrosshair" min="0.5" max="3.0" step="0.1" value="1.0" style="width:100%;"><br>

    <label for="uiScaleHealthbar">Health Bar: <span id="uiScaleHealthbar-value">1.0</span>x</label><br>
    <input type="range" id="uiScaleHealthbar" min="0.5" max="2.0" step="0.1" value="1.0" style="width:100%;"><br>

    <label for="uiScaleJumpbar">Jump Bar: <span id="uiScaleJumpbar-value">1.0</span>x</label><br>
    <input type="range" id="uiScaleJumpbar" min="0.5" max="2.0" step="0.1" value="1.0" style="width:100%;"><br>

    <label for="uiScaleMinimap">Minimap: <span id="uiScaleMinimap-value">1.0</span>x</label><br>
    <input type="range" id="uiScaleMinimap" min="0.5" max="2.0" step="0.1" value="1.0" style="width:100%;"><br>

    <label for="minimapZoomRange">Minimap Zoom: <span id="minimapZoomRange-value">200</span> (Z key)</label><br>
    <input type="range" id="minimapZoomRange" min="10" max="300" step="10" value="200" style="width:100%;"><br>

    <label for="sideViewZoomRange">Side View Zoom: <span id="sideViewZoomRange-value">300</span> (Z key)</label><br>
    <input type="range" id="sideViewZoomRange" min="10" max="500" step="10" value="300" style="width:100%;"><br>

    <label for="uiScaleWeaponUI">Weapon UI: <span id="uiScaleWeaponUI-value">1.0</span>x</label><br>
    <input type="range" id="uiScaleWeaponUI" min="0.5" max="2.0" step="0.1" value="1.0" style="width:100%;"><br>

    <hr style="border-color:#555;margin:8px 0;">
    <b style="font-size:10px;">Sniper Scope Mode:</b><br>
    <div style="margin-top:5px;">
      <button id="scopeModeForward" style="padding:4px 8px;background:rgba(80,160,220,0.2);color:#8ab0c8;border:1px solid rgba(80,160,220,0.3);border-radius:3px;cursor:pointer;font-family:inherit;font-size:10px;">Forward Position</button>
      <button id="scopeModeFocal" style="padding:4px 8px;background:rgba(80,140,200,0.08);color:rgba(138,176,200,0.5);border:1px solid rgba(80,160,220,0.15);border-radius:3px;cursor:pointer;font-family:inherit;font-size:10px;">Focal Length</button>
    </div>
    <div id="scopeModeDesc" style="margin-top:5px;font-size:9px;color:rgba(138,176,200,0.4);">Camera moves forward (may clip through walls)</div>
  </div>

  <!-- GMD (Gun Mechanics Debug) Tab -->
  <div class="tab-content" id="tab-gmd" style="padding: 10px; display: none;">
    <b style="font-size:11px; color:#5a90b0;">Gun Mechanics Debug</b><br><br>
    <label style="font-size:11px;"><input type="checkbox" id="showGMD" checked> Show debug overlay</label><br><br>
    <label style="font-size:11px;"><input type="checkbox" id="showTestTarget" checked> Enable test target</label><br><br>
    <label style="font-size:11px;"><input type="checkbox" id="showMinimaps" checked> Show minimaps &amp; legend</label><br><br>

    <b style="font-size:10px; color:#8ab0c8;">Target Controls</b><br>
    <label for="targetDistance">Distance: <span id="targetDistance-value">25</span></label><br>
    <input type="range" id="targetDistance" min="5" max="200" value="25" style="width:100%;"><br>

    <label for="targetRadius">Radius: <span id="targetRadius-value">2.0</span></label><br>
    <input type="range" id="targetRadius" min="0.5" max="10" step="0.5" value="2" style="width:100%;"><br>

    <button id="resetHitCount" style="margin-top:8px;padding:4px 10px;background:rgba(80,140,200,0.08);color:rgba(138,176,200,0.5);border:1px solid rgba(80,160,220,0.15);border-radius:3px;cursor:pointer;font-family:inherit;">Reset Hit/Miss Count</button>
  </div>

  <!-- Debug Tab -->
  <div class="tab-content" id="tab-debug" style="padding: 10px; display: none; font-size: 11px;">
    <b>FPS:</b> <span id="debug-fps">0</span><br>
    <b>Bullets:</b> <span id="debug-bulletcount">0</span><br>
    <hr style="border-color:#555;margin:5px 0;">
    <b>Player Position:</b><br>
    <span id="debug-playerposition">-</span><br>
    <b>Player Rotation:</b><br>
    <span id="debug-playerrotation">-</span><br>
    <hr style="border-color:#555;margin:5px 0;">
    <b>Last Bullet Pos:</b><br>
    <span id="debug-lastbulletpos">-</span><br>
    <b>Last Bullet Screen:</b><br>
    <span id="debug-lastbulletscreen">-</span><br>
    <b>Destroyed Pos:</b><br>
    <span id="debug-lastbulletdestroyedpos">-</span><br>
    <b>Destroyed Reason:</b><br>
    <span id="debug-lastbulletdestroyedreason">-</span>
  </div>

  <!-- Save/Reset Buttons -->
  <div style="padding: 10px; border-top: 1px solid rgba(80,160,220,0.12); display: flex; gap: 8px;">
    <button id="saveSettings" style="flex:1; padding:8px; background:rgba(40,120,80,0.25); color:#6abf8a; border:1px solid rgba(40,160,80,0.3); border-radius:3px; cursor:pointer; font-family:inherit; font-size:11px; letter-spacing:1px; text-transform:uppercase;">Save</button>
    <button id="resetSettings" style="flex:1; padding:8px; background:rgba(160,60,40,0.2); color:#c07060; border:1px solid rgba(160,80,60,0.3); border-radius:3px; cursor:pointer; font-family:inherit; font-size:11px; letter-spacing:1px; text-transform:uppercase;">Reset</button>
    <button onclick="localStorage.removeItem('voxelspace_display_config'); this.textContent='Cleared!'; setTimeout(()=>this.textContent='Clear Cache',1500);" style="flex:1; padding:8px; background:rgba(80,140,200,0.1); color:#8ab0c8; border:1px solid rgba(80,160,220,0.2); border-radius:3px; cursor:pointer; font-family:inherit; font-size:11px; letter-spacing:1px; text-transform:uppercase;">Clear Cache</button>
  </div>
</div>

<!-- Game Container - holds canvas and all HUD elements -->
<div id="game-container">
    <canvas id="fullscreenCanvas" width="800" height="450"></canvas>

    <div id="crosshair"></div>
    <div id="healthbar">
        <div id="health"></div>
    </div>
    <div id="jumpbar">
        <div id="jumpcharge"></div>
    </div>
</div>

<!-- Controls canvas for portrait mobile - positioned below game canvas -->
<canvas id="controls-canvas" style="display:none; position:absolute; left:0; image-rendering:pixelated; image-rendering:crisp-edges;"></canvas>

<!-- Debug elements (hidden) -->
<div id="fps"></div>
<div id="lastbulletdestroyedreason"></div>
<div id="lastbulletdestroyedpos"></div>
<div id="lastbulletpos"></div>
<div id="lastbulletscreen"></div>
<div id="playerrotation"></div>
<div id="playerposition"></div>
<div id="bulletcount"></div>
<div id="info">Keyboard: WASD move, Mouse look, LMB shoot, RMB toggle ADS, HOLD Space jump, Shift sprint, C crouch, R reload, Q swap weapon, E pickup | Gamepad: Left Stick move, Right Stick look, RT shoot, LT toggle ADS, HOLD LB jump, B crouch, X reload, Y swap weapon, L3/A sprint</div>

<!-- ===================================== -->
<!-- Nakama JS SDK                        -->
<!-- ===================================== -->
<script src="https://cdn.jsdelivr.net/npm/@heroiclabs/nakama-js/dist/nakama-js.umd.js"></script>

<!-- ===================================== -->
<!-- Multiplayer Network Layer            -->
<!-- ===================================== -->
<script src="src/network/nakamaClient.js?v=3"></script>
<script src="src/network/multiplayer.js?v=2"></script>

<!-- ===================================== -->
<!-- Multiplayer UI                       -->
<!-- ===================================== -->
<script src="src/ui/loginScreen.js"></script>
<script src="src/ui/clanScreen.js"></script>

<!-- ===================================== -->
<!-- External Modules (config definitions) -->
<!-- ===================================== -->
<script src="modules/displayConfig.js"></script>
<script src="modules/weaponConfig.js"></script>
<script src="modules/scopeForwardPosition.js"></script>
<script src="modules/scopeFocalLength.js"></script>

<!-- ===================================== -->
<!-- src/ files - Core Foundation         -->
<!-- ===================================== -->
<script src="src/core/polyfills.js"></script>
<script src="src/core/globals.js"></script>
<script src="src/core/configLoader.js"></script>

<!-- ===================================== -->
<!-- src/ files - Rendering Pipeline      -->
<!-- ===================================== -->
<script src="src/rendering/remotePlayerRenderer.js?v=2"></script>
<script src="src/rendering/screenBuffer.js"></script>
<script src="src/rendering/voxelEngine.js"></script>
<script src="src/rendering/cubeRenderer.js"></script>
<script src="src/rendering/itemRenderer.js"></script>

<!-- ===================================== -->
<!-- src/ files - Entities                -->
<!-- ===================================== -->
<script src="src/entities/camera.js?v=2"></script>
<script src="src/entities/testTarget.js"></script>
<script src="src/entities/items.js"></script>

<!-- ===================================== -->
<!-- src/ files - Weapons                 -->
<!-- ===================================== -->
<script src="src/weapons/gunMechanics.js"></script>
<script src="src/weapons/gunRenderer.js"></script>

<!-- ===================================== -->
<!-- src/ files - Scope                   -->
<!-- ===================================== -->
<script src="src/scope/scopeManager.js"></script>

<!-- ===================================== -->
<!-- src/ files - UI                      -->
<!-- ===================================== -->
<script src="src/ui/minimap.js"></script>
<script src="src/ui/debugInfo.js"></script>
<script src="src/ui/scoreboard.js"></script>
<script src="src/ui/weaponUI.js"></script>
<script src="src/ui/touchControls.js"></script>

<!-- ===================================== -->
<!-- src/ files - Input                   -->
<!-- ===================================== -->
<script src="src/input/keyboard.js"></script>
<script src="src/input/mouse.js"></script>
<script src="src/input/gamepad.js"></script>
<script src="src/input/touch.js"></script>

<!-- ===================================== -->
<!-- src/ files - Map                     -->
<!-- ===================================== -->
<script src="src/map/mapLoader.js"></script>

<!-- ===================================== -->
<!-- src/ files - Settings                -->
<!-- ===================================== -->
<script src="src/settings/settingsManager.js"></script>

<!-- ===================================== -->
<!-- src/ files - Main Entry Point        -->
<!-- ===================================== -->
<script src="src/main.js?v=2"></script>

</body>
</html>
